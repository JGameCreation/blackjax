:py:mod:`blackjax.mcmc.integrators`
===================================

.. py:module:: blackjax.mcmc.integrators

.. autoapi-nested-parse::

   Symplectic, time-reversible, integrators for Hamiltonian trajectories.



Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   blackjax.mcmc.integrators.velocity_verlet
   blackjax.mcmc.integrators.mclachlan
   blackjax.mcmc.integrators.yoshida



.. py:function:: velocity_verlet(logdensity_fn: Callable, kinetic_energy_fn: blackjax.mcmc.metrics.EuclideanKineticEnergy) -> EuclideanIntegrator

   The velocity Verlet (or Verlet-Störmer) integrator.

   The velocity Verlet is a two-stage palindromic integrator [BS18]_ of the form
   (a1, b1, a2, b1, a1) with a1 = 0. It is numerically stable for values of
   the step size that range between 0 and 2 (when the mass matrix is the
   identity).

   While the position (a1 = 0.5) and velocity Verlet are the most commonly used
   in samplers, it is known in the numerical computation literature that the
   value $a1 pprox 0.1932$ leads to a lower integration error
   [McL95]_, [Sch10]_. The authors of [BS18]_ show that the
   value $a1 pprox 0.21132$ leads to an even higher step acceptance rate, up
   to 3 times higher than with the standard position verlet (p.22, Fig.4).

   By choosing the velocity verlet we avoid two computations of the gradient
   of the kinetic energy. We are trading accuracy in exchange, and it is not
   clear whether this is the right tradeoff.


   .. rubric:: References

   .. [BS18] Bou-Rabee, Nawaf, and Jesús Marıa Sanz-Serna. "Geometric
           integrators and the Hamiltonian Monte Carlo method." Acta Numerica 27
           (2018): 113-206.
   .. [McL95] McLachlan, Robert I. "On the numerical integration of ordinary
           differential equations by symmetric composition methods." SIAM Journal on
           Scientific Computing 16.1 (1995): 151-168.
   .. [Sch10] Schlick, Tamar. Molecular modeling and simulation: an
           interdisciplinary guide: Vol. 21. Springer
           Science & Business Media, 2010.


.. py:function:: mclachlan(logdensity_fn: Callable, kinetic_energy_fn: Callable) -> EuclideanIntegrator

   Two-stage palindromic symplectic integrator derived in [BCS14]_

   The integrator is of the form (b1, a1, b2, a1, b1). The choice of the parameters
   determine both the bound on the integration error and the stability of the
   method with respect to the value of `step_size`. The values used here are
   the ones derived in [McL95]_; note that [BCS14]_ is more focused on stability
   and derives different values.

   .. rubric:: References

   .. [BCS14] Blanes, Sergio, Fernando Casas, and J. M. Sanz-Serna. "Numerical
           integrators for the Hybrid Monte Carlo method." SIAM Journal on Scientific
           Computing 36.4 (2014): A1556-A1580.
   .. [McL95] McLachlan, Robert I. "On the numerical integration of ordinary
           differential equations by symmetric composition methods." SIAM Journal on
           Scientific Computing 16.1 (1995): 151-168.


.. py:function:: yoshida(logdensity_fn: Callable, kinetic_energy_fn: Callable) -> EuclideanIntegrator

   Three stages palindromic symplectic integrator derived in [BCS14]_

   The integrator is of the form (b1, a1, b2, a2, b2, a1, b1). The choice of
   the parameters determine both the bound on the integration error and the
   stability of the method with respect to the value of `step_size`. The
   values used here are the ones derived in [BCS14]_ which guarantees a stability
   interval length approximately equal to 4.67.

   .. rubric:: References

   .. [BCS14] Blanes, Sergio, Fernando Casas, and J. M. Sanz-Serna. "Numerical
           integrators for the Hybrid Monte Carlo method." SIAM Journal on Scientific
           Computing 36.4 (2014): A1556-A1580.


